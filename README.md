  # Overrides #

  Зачастую в проекте возникает необходимость изменить версию той или иной библиотеки. Это может быть связано с тем, что в пакете обнаружен
баг или уязвимость и нужно установить либо предшествующую версию, в которой этих проблем нет, либо вариант библиотеки уже с исправлениями. Также возможно необходимо
использовать функционал, который появился (либо еще  не убран) из какой-то конкретной версии библиотеки. Наконец порой необходимо работать с предрелизными версиями пакетов.
  Конечно все пакетные менеджеры позволяют установить конкретную версию библиотеки. Однако нередко тот или иной пакет встречается в дереве зависимостей несколько раз:

```javascript
  // package.lock.json
  "some-components": {
    ...
    "requires": {
      ...
      "some-ui": "^1.1.0"
    }
  },
  "some-forms": {
    ...
    "requires": {
      ...
      "some-ui": "^1.2.0"
    }
  },
  "some-ui": {
    "version": "1.2.0-rc23"
    ...
  }
```

  Здесь у нас сразу 3 версии библиотеки `some-ui`. Это может привести к проблемам с совместимостью, если API или поведение между версиями отличаются. Это особенно критично для библиотек, которые
должны быть в единственном экземпляре (например, `react`). К слову сказать, даже если бы в примере выше нам не надо было бы использовать предрелизную версию `1.2.0-rc23` пакета `some-ui`,
все равно мог встать вопрос обеспечения совместимости библиотек `some-components` и `some-forms`. Даже если есть доступ к этим библиотекам, менять версии зависимостей непосредственно в них каждый раз очень неудобно - возникает необходимость новых публикаций. Ну и естественно доступ к разработке и публикации есть далеко не всегда.
  В этой ситуации может выручить поле `overrides` в `package.json` - свойство, позволяющее явно указать какую версию библиотеки использовать в дереве зависимостей, даже если эта версия отличается
  от той, что указана в исходных пакетах, которое появилось в `npm` в версии `8.3.0`. Аналогичным образом работает поле `resolutions` для `yarn`. Есть похожий функционал и у `pnpm` - свойство `overrides`.

  Итак, необходимо указать нужную версию:

```javascript
  // package.json
  "overrides": {
    "some-ui": "1.2.0-rc23"
  }
```
  или
```javascript
  // package.json
  "resolutions": {
    "some-ui": "1.2.0-rc23"
  }
```
  или 
```javascript
  // package.json
  "pnpm": {
    "overrides": {
      "some-ui": "1.2.0-rc23"
    }
  }
```
  А затем переустановить зависимости.

Но есть несколько нюансов.

Во-первых, пакетные менеджеры учитывают только "свои" поля в `package.json`. То есть `yarn` будет игнорировать свойство `overrides`, а `npm` пропустит поле `resolutions`. 
Это ещё один аргумент в пользу того, чтобы на проекте всей командой постоянно использовать один пакетный менеджер.

Второй момент - после добавления/изменения поля `overrides` перед переустановкой пакетов надо удалить папку `node_modules` и все `.lock` файлы для того, чтобы
менеджер пакетов заново пересчитал дерево зависимостей и гарантировано установил библиотеки согласно новым правилам переопределения.

Поле `overrides` - довольное мощное средство для ручного переопределения зависимостей. C помощь можно не только задать глобально для всего проекта одну версию библиотеки,
но также можно это сделать для отдельного узла в дереве зависимостей.




